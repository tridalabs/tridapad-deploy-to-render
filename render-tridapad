#!/bin/bash
set -e

export PYTHONUNBUFFERED=1

# Set TridaPad host from Render's environment variable
export TRIDAPAD_HOST="$RENDER_EXTERNAL_HOSTNAME"

# Configure Redis URL from Render's Redis service (if available)
# Falls back to localhost:6379 if REDIS_HOSTPORT is not set
if [ -n "$REDIS_HOSTPORT" ]; then
    export TRIDAPAD_REDIS_URL="redis://${REDIS_HOSTPORT}/0"
fi

# Execute the main docker-entrypoint script with passed arguments
exec /app/bin/docker-entrypoint "$@"
